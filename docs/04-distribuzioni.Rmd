---
title: "Statistica e Sociologia Generale"
subtitle: "Corso di laurea in TECNICHE DELLA PREVENZIONE NELL'AMBIENTE E NEI LUOGHI DI LAVORO"
author: "[CorradoLanera](www.CorradoLanera.it)"
date: "2022-04-07 (last update: `r Sys.Date()`)"
institute: "[Unit of Biostatistics, Epidemiology, and Public Health](https://www.unipd-ubep.it/) --- University of Padova"
output: 
  xaringan::moon_reader:
    seal: false  # no title slide! Do It Yourself here below
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
    css: xaringan-themer.css
---
class: center, middle, bg_title, hide-count


<img src="img/logo_800anni.png" width="150px"/>
<img src="img/DSCTV.png" width="50px"/>
<img src="img/UBEP.png" width="50px"/>
<img src="img/LAIMS.png" width="50px"/>

```{r setup, include=FALSE}
options(
  htmltools.dir.version = FALSE,
  htmltools.preserve.raw = FALSE
)

knitr::opts_chunk$set(
  warning = FALSE,
  message = FALSE,
  comment = "",
  out.width = "100%"
)
library(knitr)
library(xaringanExtra)
library(xaringanthemer)

library(tidyverse)
library(here)
library(gridExtra)
library(rms)


library(countdown)
library(metathis)

options(width = 59) # fit into the right-column slides

```


```{r xaringans, echo=FALSE}
# https://github.com/gadenbuie/xaringanExtra
use_tachyons()
use_share_again()
use_panelset()
use_clipboard()
use_editable(expires = 1)
use_freezeframe()
use_extra_styles(
  hover_code_line = TRUE,         #<<
  mute_unhighlighted_code = TRUE  #<<
)
use_progress_bar(color = "#0051BA", location = "top")
```

```{r style-share-again, echo=FALSE}
style_share_again(
  share_buttons = c("twitter", "linkedin", "pocket")
)
```


```{r meta, echo=FALSE}
meta() %>%
  meta_general(
    description = "Modulo di STATISTICA MEDICA del corso in STATISTICA E SOCIOLOGIA GENERALE per il corso di laurea in TECNICHE DELLA PREVENZIONE NELL'AMBIENTE E NEI LUOGHI DI LAVORO",
    generator = "xaringan and remark.js"
  ) %>% 
  meta_name("github-repo" = "CorradoLanera/tpall") %>% 
  meta_social(
    title = "Statistica e Sociologia Generale",
    url = "https://corradolanera.github.io/tpall/#1",
    image = "https://github.com/CorradoLanera/tpall/raw/main/docs/img/cover.jpg",
    og_type = "website",
    og_author = "UBEP",
    twitter_card_type = "summary",
    twitter_creator = "@CorradoLanera"
  )
```

```{css, echo=FALSE}
.left-code {
  color: #777;
  width: 38%;
  height: 92%;
  float: left;
}
.right-code {
  color: #777;
  width: 55%;
  height: 92%;
  float: right;
  padding-top: 0.5em;
}
.left-plot {
  width: 43%;
  float: left;
}
.right-plot {
  width: 60%;
  float: right;
}
.hide-count .remark-slide-number {
  display: none;
}

.bg_title {
  position: relative;
  z-index: 1;
}

.bg_title::before {    
      content: "";
      background-image: url('img/bg1.png');
      background-size: contain;
      position: absolute;
      top: 0px;
      right: 0px;
      bottom: 0px;
      left: 0px;
      opacity: 0.3;
      z-index: -1;
}

```


```{r xaringan-themer, include=FALSE, warning=FALSE}
red <- "#f34213"
purple <- "#3e2f5b"
orange <- "#ff8811"
green <- "#136f63"
white <- "#FFFFFF"
pastel_orange <- "#F97B64"
blu_gray <- "#1F4257"
style_duo_accent(
    colors = c(
        red = red,
        purple = purple,
        orange = orange,
        green = green,
        white = white,
        pastel_orange = pastel_orange,
        blu_gray = blu_gray
    )
)
```


<br>
<br>
<br>

# **STATISTICA E SOCIOLOGIA GENERALE**<br>**.orange[STATISTICA MEDICA]**

-- Distribuzioni di probabilità --


<br>
<br>

C.d.L. **Tecniche della prevenzione nell'ambiente e nei luoghi di lavoro**

Feltre, a.a. 2021/2022 - 20 ore (2 crediti)

Corrado Lanera | [**Unità di Biostatistica, Epidemiologia e Salute Pubblic**](https://www.unipd-ubep.it/)






---
class: inverse, hide-count

# Cosa faremo


---
class: hide-count

# .orange[Riconoscimenti]

- Le diapositive proposte sono state prodotte a partire anche da
  materiale generato da/con le seguenti persone gravitanti attorno
  l'UBEP*:
  
  + Danila Azzolina
  + Dario Gregori
  + Giulia Lorenzoni
  + Ileana Baldi
  + Luca Vedovelli
  + Matteo Martinato
  + Paola Berchialla

<br><br>
<small>
.right[\* In ordine alfabetico.]
</small>

<br><br>

> Un ringraziamento speciale a Cristiana Vettori e a Mariasole Rizzi per
l'aiuto e il supporto logistico e amministrativo che mi è stato offerto,
e ad Andrea Francavilla per avermi aiutato nella revisione del
materiale.

---
class: inverse, middle

# .center[**.orange[Panoramica]**]

**Modello** probabilistico per variabili discrete: massa, valore atteso e varianza 

Distribuzione **binomiale** (ovvero per variabili con due soli possibili esiti)

Distribuzione di **Poisson** (ovvero per varibili _conteggio_) e approssimazione della binomiale

**Modello** probabilistico per variabili continue: densità

Distribuzione **normale**, localizzazione, forma, simmetria, percentili, trasformazioni 

**Approssimazioni** alla Normale










---
class: inverse, middle

# .center[Modelli (probabilistici) **.orange[discreti]**]

- **Massa**

- **Valore atteso**

- **Varianza**



---
# Richiamo: .orange[Variabile casuale]

Una variabile casuale è una quantità che assume **valori differenti** con **specifiche probabilità**

- una variabile casuale che assume un .orange[insieme discreto] di valori con probabilità specificata à detta variabile casuale **discreta**

- una variabile casuale che assume un .orange[insieme continuo] (e infinito) di valori, in modo che **gli intervalli** di tali valori abbiano probabilità specificata è detta variabile casuale continua

<br>
<br>
<br>
<br>
<br>

> Nota: una funzione di una variabile casuale **è** una variabile casuale

 

> Nota 2: **funzione**: una qualunque mappa/regola che associa **a ogni elemento** di un insieme (.orange[dominio] della funzione) **un unico elemento** di un un insieme (.orange[codominio] della funzione).


---
# .orange[Modelli discreti]

Obiettivo è determinare il modello probabilistico adatto ai dati
che si vuole trattare, ovvero individuare eventi con la stessa struttura probabilistica

- distribuzione .orange[binomiale], in cui l'evento di interesse ha due possibili esiti 

- distribuzione di .orange[Poisson], in cui l'evento di interesse è definito dal conteggio di eventi





---
# .orange[Modelli discreti]: massa

.panelset[
.panel[.panel-name[Definizione]

Una funzione di (distribuzione di) .orange[massa] di probabilità è una relazione matematica, o regola, che assegna **ad ogni possibile valore** $r$ di una variabile casuale discreta $X$ **la (sua) probabilità** $P(X=r)$.

Questa regola è definita per tutti i valori $r$ che hanno probabilità positiva.

<br>
<br>
<br>
<br>

> Importante: Valgono sempre:
>
>  - $0\leq P(X=r) \leq 1$
>
>  - $\sum P(X=r) = 1$

]
.panel[.panel-name[Esempio]


Un medico inizia a controllare lo stato ipertensivo di 4 suoi pazienti con farmaci antiipertensivi.

**Sia**: $X$ è il numero di pazienti complianti

**Allora**:

```{r, echo=FALSE}
ipertensione <- tibble::tibble(
  r = c(0, 1, 2, 3, 4),
  `P(X=r)` = c(0.008, 0.076, 0.265, 0.411, 0.240)
)

knitr::kable(ipertensione)
```

]


.panel[.panel-name[Distr. Cumulativa]

La distribuzione cumulativa di una variabile casuale discreta è indicata come $F(x)$ ed è pari a $P(X\leq x)$
]

.panel[.panel-name[Esempio]

$$F(x) = P(X\leq x)$$
.left-column[
```{r, echo=FALSE}
ipertensione |> 
  dplyr::mutate(
    `F(x)` = cumsum(.data[["P(X=r)"]])
  ) |> 
  knitr::kable()
```
]

.right-plot[

```{r, echo=FALSE, out.width="80%"}
ipertensione |> 
  dplyr::mutate(
    `F(x)` = cumsum(.data[["P(X=r)"]])
  ) |> 
  ggplot(aes(r, `F(x)`)) +
  geom_step(colour = "blue") + 
  geom_point(aes(y = .data[["P(X=r)"]]), colour = "red") +
  theme_bw() +
  ggtitle(
    "Distribuzione Cumulativa Empirica",
    subtitle = "In rosso la massa di probabilità per ciascun corrispondente possibile valore."
  )
```

  
]

]

]
---
# .orange[Modelli discreti]: valore atteso

.panelset[
.panel[.panel-name[Definizione]

Il valore atteso di una variabile casuale discreta è definito come

$$E(X)=\sum_{i\in  I}x_iP(X=x_i)$$

dove $x_i$ sono i valori che la variabile casuale $X$ assume con probabilità positiva
]
.panel[.panel-name[Esempio]


Per la variabile $X =$ _pazienti complianti al controllo dell'ipertensione_

```{r, include=FALSE}
media_ipertensione <- sum(
  ipertensione[["r"]] * ipertensione[["P(X=r)"]]
)
```

$$E(X)=0(0.008)+1(0.076)+2(0.265)+3(0.411)+4(0.240) = `r media_ipertensione`$$

]
]

---
# .orange[Valore atteso]: esempio


```{r, echo = FALSE}
countdown(minutes = 1, warn_when = 1, play_sound = TRUE,
          left = "70%", bottom = "10%")
```


.panelset[
.panel[.panel-name[Problema]


**Sia**: $X$ il **numero** di episodi di otiti **nei primi due anni di vita**, con la seguente rispettiva massa di probabilità:

```{r, echo=FALSE}
otiti <- tibble::tibble(
  r = c(0, 1, 2, 3, 4, 5, 6),
  `P(X=r)` = c(0.129, 0.264, 0.271, 0.185, 0.095, 0.039, 0.017)
)
knitr::kable(otiti)
```

Determinare il numero atteso di episodi di otite nei primi due anni di vita

]

.panel[.panel-name[Soluzione]
```{r, include=FALSE}
atteso_otiti <- sum(
  otiti[["r"]] * otiti[["P(X=r)"]]
)
```

il numero atteso di episodi di episodi di otite nei primi due anni di vita è:


$$\begin{split}E(X) =\ &0(0.129)\ + \\&1(0.264)\ + \\& 2(0.271)\ + \\&3(0.185)\ + \\&4(0.095)\ + \\&5(0.039)\ + \\& 6(0.017) =\\& `r atteso_otiti` \end{split}$$

]

.panel[.panel-name[R Code]

```{r}
sum(otiti[["r"]] * otiti[["P(X=r)"]])
```

]
]

---
# .orange[Modelli discreti]: varianza

.panelset[
.panel[.panel-name[Definizione]

La varianza di una variabile casuale discreta $X$ è pari a

$$\mbox{var}(X)=\sum_{i=1}^k(x-\mu)^2P(X=x_i)=\sigma^2$$

vale anche

$$\sigma^2=E(X-\mu)=\left(\sum_{i=1}^kx_i^2P(X=x_i)\right)-\mu^2$$
]
.panel[.panel-name[Esempio]

```{r, include=FALSE}
var_otiti <- sum(
    otiti[["r"]]^2 * otiti[["P(X=r)"]]
  ) - atteso_otiti^2
```

La varianza della variabile casuale episodi di otite è pari a

$$0^2(0.129)+\ldots+36(0.017)-2.038^2=`r round(var_otiti,3)`$$

]

.panel[.panel-name[R Code]

```{r}
sum(otiti[["r"]]^2 * otiti[["P(X=r)"]]) - atteso_otiti^2
```

]
]










---
class: inverse, middle

# .center[Distribuzione **.orange[binomiale]**]

- Struttura e **.orange[distribuzione]**

- Valore **.orange[atteso]** e **.orange[varianza]**

- Grafici

---
# .orange[Binomiale]: struttura

Una variabile binomiale rapresenta la **.orange[quantità]** di esiti **positivi** di un possibile esperimento con due soli risultati possibili (**dicotomico**), che possono avvenire con date **.orange[probabilità costanti]** (complementari a 1).

Si caratterizza quindi da:

- $n$ prove **indipendenti**

- **due** possibili outcomes di ogni prova, .orange[successo] o .orange[insuccesso]

- la probabilità di successo, $p$ è .orange[costante] in ogni prova (quella di insuccesso è pari a $1-p = q$)

Ed è utile Utile per:

- valutare la probabilità di $k$ successi in $n$ prove



---
# .orange[Coefficiente binomiale]
Il numero di combinazioni di $n$ oggetti presi $k$ alla volta è pari a

$$_nC_k=\binom{n}{k}=\frac{n(n-1)\ldots (n-k+1)}{k!}$$

moltiplicando numeratore e denominatore per $(n-k)!$ si ottiene

$$_nC_k=\binom{n}{k}=\frac{n!}{k!(n-k)!}$$

>Note:
- $n! := n\cdot (n-1)\cdot \cdots \cdot (2)\cdot 1$
- convenzione: $\binom{n}{0}=1$
- vale la simmetria: $\binom{n}{k}=\binom{n}{n-k}$



---
## Distribuzione .orange[Binomiale]: probabilità

la probabilità che $k$ successi avvengano in $n$ prove, con le rimantenti $n-k$ tutte insuccessi è pari a

$$p^k(1-p)^{n-k}$$

Tenendo conto che i $k$ successi posso ottenerli in $_nC_k$ modi diversi, si ha che

$$P(X=k)=\binom{n}{k}p^k(1-p)^{n-k}$$

che è la distribuzione di probabilità binomiale

---
### Coefficiente binomiale: .orange[Triangolo di Tartaglia]

```{r, echo=FALSE, out.width="80%", fig.cap="http://matematicamente.it/6981-algebra-1-manuale-completo-per-il-primo-anno-della-secondaria-di-secondo-grado"}

knitr::include_graphics("img/Algebra1_12_fig003.svg.png")

```


---
# Distribuzione .orange[Binomiale]

.panelset[
.panel[.panel-name[Descrizone]

La distribuzione binomiale, di parametri $n$ e $p$ si indica come

$$P(S=k)=\binom{n}{k}p^k(1-p)^{n-k} \:\:\:\: k=0,1,\ldots,n$$

vale la simmetria

$$P(S=k)=\binom{n}{k}p^k(1-p)^{n-k} = \binom{n}{n-k}p^{n-k}(1-p)^{k}=P(S=n-k)$$
]

.panel[.panel-name[Esempio]

Quale è la probabilità di ottenere 2 bambini maschi da 5 nati se la probabilità di un maschio è pari a 0.51, indipendente dal sesso dei bambini nati prima?
```{r, include=FALSE}
pbin <- dbinom(
  x = 2,
  size = 5,
  prob = 0.51
)
```

Si usa la distribuzione binomiale

$$P(S=2)=\binom{5}{2}0.51^2(0.49)^{5-2}=\frac{5 \times 4}{2 \times 1}0.51^2(0.49)^{5-2}=`r round(pbin,3)`$$

```{r}
dbinom(x = 2, size = 5, prob = 0.51)

pbinom(q = 2, size = 5, prob = 0.51) -
  pbinom(q = 1, size = 5, prob = 0.51)
```


]


]



---
## .orange[Binomiale]: Valore atteso e varianza

Per definizione si ha che: $E(S) = \sum_{i\in I}x_iP(X=x_i)$

Da cui: $E(S) =\sum_{k=0}^n k\binom{n}{k}p^kq^{n-k}$

Del resto, Se $S$ è la somma degli esiti dei singoli lanci (che possimo indicare come variabile casuale $X$), allora per linearità

$$E(S) = E\left(\sum_{i=1}^n X_i\right) = \sum_{i=1}^nE(X_i) = \sum_{i=1}^np=np$$

Sempre per definizione, la varianza sarà: $\mbox{var}(S)=\sum_{k=0}^n (k-np)^2 \binom{n}{k}p^kq^{n-k}$

Che possiamo calcolare per linearità più semplicemente come

$$var(S) = var\left(\sum_{i=1}^n X_i\right) = \sum_{i=1}^nvar(X_i) =^*  \sum_{i=1}^npq=npq$$
<br>

.right[*= Se interessa, dimostrarlo per esercizio.]



---
## .orange[Singolo esperimento]: grafico

.panelset[
```{r, panelset = TRUE, out.width="60%"}

db <- tibble(
  p = seq(0, 1, by = 0.001),
  q = 1 - p,
  pq = p*q
)

ggplot(db, aes(x = p, y = pq)) +
  geom_point() +
  theme_bw() +
  ggtitle("Attesa e Varianza per distribuzione Binomiale con n = 1",
        subtitle = "(Nota anche come distribuzione Bernulli)")

```

]



---
## .orange[10 esperimenti]: grafico

.panelset[
```{r, panelset = TRUE, out.width="60%"}
n <- 10
k <- seq_len(n)
p <- c(0.05, 0.5, 0.95)


db <- crossing(p, k, n) |> 
  mutate(
    `P(S=k)` = dbinom(x = k, size = n, prob = p),
    p = factor(p)
  )

ggplot(db, aes(x = k, y = `P(S=k)`,fill = p)) +
  geom_col() +
  facet_grid(p~., scales = "free") +
  theme_bw() +
  theme(legend.position = "none") +
  ggtitle("Distribuzioni Binomiali con n = 10 e diversi valori di p")

```


]






---
class: inverse, middle

# .center[Distribuzione di **.orange[Poisson]**]

- Struttura e **.orange[distribuzione]**

- Valore **.orange[atteso]** e **.orange[varianza]**

- Grafici



---
# .orange[Poisson]: struttura

Dato un intervallo di tempo $\Delta t$, si ha che

- la probabilità di osservare un evento è direttamente proporzionale alla lunghezza dell'intervallo di tempo $\Delta t$, ovvero, per una qualche costante $\lambda$, abbiamo:

$$P(\mbox{1 evento})\sim \lambda\,\Delta t$$



- la probabilità di osservare $0$ eventi nell'intervallo $\Delta t$ è approssimativamente $1-\lambda\Delta t$

- la probabilità di osservare più di un evento nell'intervallo è sostanzialmente $0$

- .orange[Stazionarietà]: il numero di eventi per unità di tempo è lo stesso in tutto l'intervallo di tempo $t$ (no trend)

- .orange[Indipendenza]: se si verifica un evento nell'intervallo di tempo considerato, questa non modifica la probabilità di osservarne un secondo nell'intervallo successivo.


---
## Distribuzione di .orange[Poisson]: probabilità

La probabilità di osservare $k$ eventi in un periodo di tempo $t$ per una variabile aleatoria di Poisson di parametro $\lambda$ è pari a

$$P(X=k)=\frac{e^{-\mu}\mu^k}{k!}$$

dove $\mu=\lambda t$ ed $e$ è pari approssimativamente a 2.71828 è la costante di Nepero.

---
## Distribuzione di .orange[Poisson]

.panelset[
.panel[.panel-name[Esempio]

Si supponga che il numero di morti attribuite alla febbre tifoide in un anno sia una Poisson con parametro $\mu = 4.6$. Si cerca la distribuzione di probabilità su un periodo di 6 e 3 mesi

Dalla definizione si ha che $\mu = 4.6 \times 1$, quindi $\lambda = 4.6$.

Su 6 mesi si ha allora che $\mu=4.6 \times 0.5 = `r round(4.6*0.5,3)`$


$$P(X=0) = e^{-2.3} = `r round(ppois(0, lambda=2.3),3)` \:\:\:\: P(X\geq6) = 1-P(X<6)=`r round(1-sum(dpois(0:5, lambda=4.6*0.5)),3)`$$

Su 3 mesi si ha allora che $\mu=4.6 \times 0.25 = `r round(4.6*0.25,3)`$

$$P(X=0) = e^{-1.15} = `r round(ppois(0, lambda=1.15),3)` \:\:\:\: P(X\geq6) = 1-P(X<6)=`r round(1-sum(dpois(0:5, lambda=4.6*0.25)),3)`$$

]

.panel[.panel-name[R Code]
```{r, eval=FALSE}
lambda = 4.6
mesi = c(3, 6)
t <- mesi / 12
mu <- lambda * t
n <- 0:6

db <- crossing(mu, n) |> 
  mutate(
    `P(X=n)` = dpois(n, mu),
    mu = factor(mu)
  )

ggplot(db, aes(n, `P(X=n)`, fill = mu)) +
  geom_col(alpha = 0.6) +
  facet_grid(mu~., scales = "free") +
  scale_fill_(
    labels = paste0(lambda, " * ", t),
    values = c("blue", "red")
  ) +
  theme_bw()
```

]

.panel[.panel-name[Grafici]
```{r, echo=FALSE, out.width="60%"}
lambda = 4.6
mesi = c(3, 6)
t <- mesi / 12
mu <- lambda * t
n <- 0:6

db <- crossing(mu, n) |> 
  mutate(
    `P(X=n)` = dpois(n, mu),
    mu = factor(mu)
  )

ggplot(db, aes(n, `P(X=n)`, fill = mu)) +
  geom_col(alpha = 0.6) +
  facet_grid(mu~., scales = "free") +
  scale_fill_manual(
    labels = paste0(lambda, " * ", t),
    values = c("blue", "red")
  ) +
  theme_bw()
```
]
]



---
# .orange[Poisson]: valore atteso e varianza

Per una distribuzione di Poisson con parametro $\mu$, la media e la varianza sono entrambi pari a $\mu$


---
# .orange[Poisson]: Polio

Si consideri numero di morti per polio negli anni 1968-76

.pull-left[
```{r,echo=FALSE}
tibble(
Anno = c(68, 69, 70, 71, 72, 73, 74, 75 , 76),
Morti = c(24, 13, 7, 18, 2, 10, 3, 9, 16)
) |> 
  knitr::kable()
```
]

.pull-right[
La media è pari a $11.3$ e la varianza a $51.5$.

Probabilmente vi è un effetto di clustering rispetto a certi periodi temporali e a certe aree geografiche.

]


---
# .orange[Poisson]: cibo cancerogeno


In uno studio sul possibile effetto cancerogneo di EDB (etilene dibromide), osservando la mortalità di 161 operai bianchi, occupati presso due fabbriche, Texas e Michigan, 1940-1975 [Ott \em et al., B J Ind Med, 1980:37, 163-8]

Si sono osservate 7 morti per cancro. In base ai dati di mortalità degli USA, si sarebbero attese in quel periodo 5.8 morti per cancro.

Si cerca quindi la probabilità di osservare almeno 7 morti  secondo una Poisson di parametro $\mu=5.8$.

$$\begin{align}P(X \geq 7) &= 1 - P(X\leq 6)\\& = 1-(e^{-5.8}5.8^0/0!)+ \ldots + (e^{-5.8}5.8^6/6!)\\& = `r round(1-sum(dpois(0:6, lambda=5.8)),3)`\end{align}$$

```{r,echo=FALSE}
1 - sum(dpois(0:6, lambda = 5.8))
```


per cui le morti non sembrano in eccesso in questo gruppo di lavoratori.


---
# .orange[Poisson]: Approssimazone

La distribuzione Binomiale con $n$ grande e $p$ piccolo può essere accuratamente approssimata da una distribuzione di Poisson con parametro $\mu=np$

La motivazione è data dalla maggiore semplicità computazionale della distribuzione di Poisson

Una regola approssimativa è di usare l'approssimazione quando $n\geq 100$ e $p\leq 0.01$

.pull-left[

```{r,eval=FALSE}
n <- 100
p <- 0.01
tibble(
  k = 0:6,
  bin = dbinom(k, n, p),
  pois = dpois(k, n*p) 
)
```

]

.pull-right[

```{r,echo=FALSE}
n <- 100
p <- 0.01
tibble(
  k = 0:6,
  bin = dbinom(k, n, p),
  pois = dpois(k, n*p) 
) |> 
  kable()
```

]



---
# .orange[Poisson]: tumore al seno

Si studia la suscettibilità genetica per il cancro alla mammella, trovando che 4 donne su 1000 tra i 40 e i 49 anni le cui madri hanno avuto un cancro al seno, lo sviluppano nell'anno successivo di vita.

In base a studi di popolazione, si pensa che in queste classi di età si dovrebbe avere circa 1 cancro al seno su 1000 donne.

Secondo la probabilità binomiale, con $n=1000$ e $p=1/1000$ si ha che
$$\begin{split}
P(X\geq 4)& = 1 - P(X\leq 3)\\& = 1- \left [\binom{1000}{0} (.001)^0(.9999)^{1000}+\ldots+\binom{1000}{3} (.001)^3(.9999)^{997}  \right ]\\&\end{split}$$

Secondo la probabilità di Poisson, con $\mu = 1$, si ha che

$$\begin{split}P(X\geq 4)& = 1- [e^{-1}1^0/0! + \ldots + e^{-1}1^3/3!]\\&= 1- 0.9810\\& = `r round(1-sum(dpois(0:3, lambda=1)),3)`\end{split}$$

Un valore sufficientemente piccolo da far pensare ad una suscettibilità genetica.





---
class: middle, center, hide-count, inverse

# .orange[link al _vostro_ cloud:]

[https://bit.ly/tpall22-feltre-rscloud](https://bit.ly/tpall22-feltre-rscloud)


---
class: inverse

# Risorse utili

- [**RStudio Cloud**](https://bit.ly/tpall22-feltre-rscloud): [https://bit.ly/tpall22-feltre-rscloud](https://bit.ly/tpall22-feltre-rscloud) gratis per voi per esplorare RStudio, le sue funzionalità, e allenarvi con R (link di iscrizione valido fino alla fine del corso). NOTA: a vostra scelta, è utilizzabile anche come _supporto_ durante l'esame.

- [**RStudio primers**](https://rstudio.cloud/learn/primers) ambiente gratuito dentro RStudio Cloud per l'apprendimento delle basi di analisi di dati con R tramite tutorial interattivi. Una volta registrati, oltre all'accesso al _nostro_ spazio di lavoro, avete accesso libero anche ai _Primers_.

- [**R 4 Data Science**](https://r4ds.had.co.nz/): libro gratuito (on-line) di [**Hadley Wickham**](http://hadley.nz/) e [**Garrett Grolemund**](https://rstudio.com/speakers/garrett-grolemund/)

- [**GGplot2 cheatsheet**](https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf) schema dei possibili grafici di base rappresentabili in R con il pacchetto `{ggplot2}`, molto utile anche per conoscere le tipologie di grafico, e il loro utilizzo.

- [An Introduction to Medical Statistics](https://global.oup.com/academic/product/an-introduction-to-medical-statistics-9780199589920) di [**Martin Bland**](https://www.york.ac.uk/healthsciences/our-staff/honoraryemeritus/martin-bland/), suggeriti capitoli 4 e 5.


- [Perché n − 1 nella formula della deviazione standard
campionaria?](http://rdossena.altervista.org/Articoli/Book-Perch%E9%20n-1.pdf) di [Riccardo Dossena](http://rdossena.altervista.org) Traduzione dell'articolo **Book, S.A.**: _Why n − 1 in the formula for the sample standard deviation?_, The Two-Year College Mathematics Journal 10(5), 330–333 (1979


---
class: inverse, center, middle, hide-count


.bg-washed-green.b--dark-green.ba.bw2.br3.shadow-5.ph4.mt5[
.left[
_Mathematical conventions are just that, conventions. They differ by field of mathematics. Don’t ask us why **matrix rows** **.orange[are numbered down]** but **graphs** **.orange[are numbered up]** the **y axis**, nor why **x .orange[comes before] y** but **row .orange[before] column**. But the matrix layout has always seemed illogical to me._
]

.tr[
—Brian D. Ripley<br>08/2004 - R-help<br>
]
]

<br>


# **.orange[Grazie]** per l'attenzione!

... e buona settimana.

<br>
<br>


Diapositive: [https://corradolanera.github.io/tpall](https://corradolanera.github.io/tpall)


[`r fontawesome::fa("link")`](https://www.unipd-ubep.it/) [**www.unipd-ubep.it**](https://www.unipd-ubep.it/) | 
[`r fontawesome::fa("mail-bulk")`](mailto:Corrado.Lanera@ubep.unipd.it) [**Corrado.Lanera@ubep.unipd.it**](mailto:Corrado.Lanera@ubep.unipd.it)

[`r fontawesome::fa("github")`](https://github.com/corradolanera)
[`r fontawesome::fa("twitter")`](https://twitter.com/corradolanera)
[`r fontawesome::fa("telegram-plane")`](https://telegram.me/CorradoLanera)
**@CorradoLanera** |
[`r fontawesome::fa("calendar-check")` ](https://calendly.com/corradolanera) [**calendly.com/corradolanera**](https://calendly.com/corradolanera)


